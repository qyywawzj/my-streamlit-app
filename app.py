import streamlit as st
from PIL import Image
import requests
from io import BytesIO

# ========== é¡µé¢é…ç½® ==========
st.set_page_config(page_title="å…¨èƒ½å¨ç¥åŠ©æ‰‹ï¼ˆç¬¬ä¸€éƒ¨åˆ†ï¼‰", page_icon="ğŸ³", layout="wide")

# ========== å›¾ç‰‡åŠ è½½å‡½æ•° ==========
def load_image_from_url(url, width=350):
    try:
        response = requests.get(url, timeout=10)
        response.raise_for_status()
        img = Image.open(BytesIO(response.content))
        return img.resize((width, int(width * img.height / img.width)))
    except Exception as e:
        placeholder = Image.new('RGB', (width, 250), color='#cccccc')
        return placeholder

# ========== èœè°±æ•°æ®åº“ï¼ˆç¬¬ä¸€éƒ¨åˆ†ï¼š30é“èœï¼‰ ==========
RECIPES = {
    # ========== åŸæœ‰åŸºç¡€èœï¼ˆ12é“ï¼Œè¡¥å…¨img_urlï¼‰ ==========
    # æ±¤ç±»
    "ç•ªèŒ„é¸¡è›‹æ±¤": {
        "category": "æ±¤ç±»",
        "time": "15åˆ†é’Ÿ",
        "img_url": "https://img1.doubanio.com/view/photo/l/public/s3435992038.jpg",
        "ingredients": [
            {"name": "ç•ªèŒ„", "amount": "200å…‹"},
            {"name": "é¸¡è›‹", "amount": "2ä¸ª"},
            {"name": "è‘±èŠ±", "amount": "10å…‹"},
            {"name": "ç›", "amount": "3å…‹"}
        ],
        "steps": "1. ç•ªèŒ„åˆ‡å—ï¼ˆ3åˆ†é’Ÿï¼‰\n2. é¸¡è›‹æ‰“æ•£ï¼ˆ2åˆ†é’Ÿï¼‰\n3. æ°´çƒ§å¼€æ”¾ç•ªèŒ„ç…®3åˆ†é’Ÿ\n4. å€’å…¥è›‹æ¶²å½¢æˆè›‹èŠ±ï¼ˆ2åˆ†é’Ÿï¼‰\n5. åŠ ç›æ’’è‘±èŠ±ï¼ˆ2åˆ†é’Ÿï¼‰",
        "alternatives": "ç•ªèŒ„â†’å«©è±†è…ï¼ˆ150å…‹ï¼‰\né¸¡è›‹â†’é¹Œé¹‘è›‹ï¼ˆ8ä¸ªï¼‰",
        "nutrition": "çƒ­é‡120å¤§å¡ | è›‹ç™½è´¨8g | ç»´ç”Ÿç´ Cä¸°å¯Œ",
        "tips": "æ·‹è›‹æ¶²æ—¶ç«è¦å°"
    },
    "ç‰ç±³æ’éª¨æ±¤": {
        "category": "æ±¤ç±»",
        "time": "90åˆ†é’Ÿ",
        "img_url": "https://img9.doubanio.com/view/photo/l/public/s3435992050.jpg",
        "ingredients": [
            {"name": "æ’éª¨", "amount": "500å…‹"},
            {"name": "ç‰ç±³", "amount": "2æ ¹"},
            {"name": "èƒ¡èåœ", "amount": "1æ ¹"},
            {"name": "å§œ", "amount": "20å…‹"}
        ],
        "steps": "1. æ’éª¨ç„¯æ°´ï¼ˆ10åˆ†é’Ÿï¼‰\n2. ç‰ç±³èƒ¡èåœåˆ‡å—ï¼ˆ5åˆ†é’Ÿï¼‰\n3. æ‰€æœ‰ææ–™åŠ æ°´ç‚–60åˆ†é’Ÿ\n4. åŠ ç›è°ƒå‘³ï¼ˆ2åˆ†é’Ÿï¼‰",
        "alternatives": "æ’éª¨â†’é¸¡æ¶ï¼ˆ2ä¸ªï¼‰",
        "nutrition": "çƒ­é‡280å¤§å¡ | é’™è´¨ä¸°å¯Œ",
        "tips": "ç„¯æ°´ç”¨å†·æ°´ä¸‹é”…"
    },
    # ç²¥ç±»
    "çš®è›‹ç˜¦è‚‰ç²¥": {
        "category": "ç²¥ç±»",
        "time": "60åˆ†é’Ÿ",
        "img_url": "https://img2.doubanio.com/view/photo/l/public/s3435992051.jpg",
        "ingredients": [
            {"name": "å¤§ç±³", "amount": "100å…‹"},
            {"name": "çš®è›‹", "amount": "2ä¸ª"},
            {"name": "ç˜¦è‚‰", "amount": "100å…‹"},
            {"name": "å§œä¸", "amount": "10å…‹"}
        ],
        "steps": "1. å¤§ç±³æµ¸æ³¡30åˆ†é’Ÿ\n2. ç˜¦è‚‰åˆ‡ä¸è…Œåˆ¶ï¼ˆ10åˆ†é’Ÿï¼‰\n3. ç…®ç²¥30åˆ†é’Ÿ\n4. åŠ å…¥è‚‰ä¸çš®è›‹ç…®10åˆ†é’Ÿ\n5. åŠ å§œä¸ç›ï¼ˆ2åˆ†é’Ÿï¼‰",
        "alternatives": "ç˜¦è‚‰â†’é¸¡èƒ¸è‚‰ï¼ˆ100å…‹ï¼‰",
        "nutrition": "çƒ­é‡250å¤§å¡ | æ˜“æ¶ˆåŒ–",
        "tips": "ç±³æå‰æµ¸æ³¡æ›´æ˜“ç…®çƒ‚"
    },
    "å°ç±³å—ç“œç²¥": {
        "category": "ç²¥ç±»",
        "time": "40åˆ†é’Ÿ",
        "img_url": "https://img1.doubanio.com/view/photo/l/public/s3435992052.jpg",
        "ingredients": [
            {"name": "å°ç±³", "amount": "80å…‹"},
            {"name": "å—ç“œ", "amount": "200å…‹"},
            {"name": "æ¸æ", "amount": "10å…‹"}
        ],
        "steps": "1. å—ç“œå»çš®åˆ‡å—ï¼ˆ5åˆ†é’Ÿï¼‰\n2. å°ç±³æ·˜æ´—ï¼ˆ2åˆ†é’Ÿï¼‰\n3. ä¸€èµ·ç…®30åˆ†é’Ÿ\n4. åŠ æ¸æå†ç…®5åˆ†é’Ÿ",
        "alternatives": "å—ç“œâ†’çº¢è–¯ï¼ˆ200å…‹ï¼‰",
        "nutrition": "çƒ­é‡180å¤§å¡ | å…»èƒƒ",
        "tips": "é€‰è€å—ç“œæ›´ç”œ"
    },
    # é¥­ç±»
    "ç•ªèŒ„ç‚’é¥­": {
        "category": "é¥­ç±»",
        "time": "20åˆ†é’Ÿ",
        "img_url": "https://img2.doubanio.com/view/photo/l/public/s3435992039.jpg",
        "ingredients": [
            {"name": "ç±³é¥­", "amount": "300å…‹"},
            {"name": "ç•ªèŒ„", "amount": "150å…‹"},
            {"name": "é¸¡è›‹", "amount": "2ä¸ª"},
            {"name": "ç«è…¿", "amount": "50å…‹"}
        ],
        "steps": "1. ç•ªèŒ„ç«è…¿åˆ‡ä¸ï¼ˆ5åˆ†é’Ÿï¼‰\n2. é¸¡è›‹ç‚’ç†Ÿï¼ˆ3åˆ†é’Ÿï¼‰\n3. ç‚’ç•ªèŒ„è‡³å‡ºæ±ï¼ˆ4åˆ†é’Ÿï¼‰\n4. åŠ ç±³é¥­ç«è…¿ç¿»ç‚’ï¼ˆ5åˆ†é’Ÿï¼‰\n5. åŠ é¸¡è›‹ç›ç¿»ç‚’ï¼ˆ3åˆ†é’Ÿï¼‰",
        "alternatives": "ç«è…¿â†’è™¾ä»ï¼ˆ80å…‹ï¼‰",
        "nutrition": "çƒ­é‡350å¤§å¡ | ç¢³æ°´å……è¶³",
        "tips": "ç”¨éš”å¤œé¥­æ›´ç²’ç²’åˆ†æ˜"
    },
    # ç‚’èœç±»
    "ç•ªèŒ„ç‚’è›‹": {
        "category": "ç‚’èœ",
        "time": "15åˆ†é’Ÿ",
        "img_url": "https://img9.doubanio.com/view/photo/l/public/s3435992040.jpg",
        "ingredients": [
            {"name": "ç•ªèŒ„", "amount": "300å…‹"},
            {"name": "é¸¡è›‹", "amount": "3ä¸ª"},
            {"name": "è‘±", "amount": "10å…‹"},
            {"name": "ç³–", "amount": "5å…‹"}
        ],
        "steps": "1. ç•ªèŒ„åˆ‡å—ï¼ˆ3åˆ†é’Ÿï¼‰\n2. é¸¡è›‹æ‰“æ•£ï¼ˆ2åˆ†é’Ÿï¼‰\n3. ç‚’é¸¡è›‹è‡³å‡å›ºï¼ˆ3åˆ†é’Ÿï¼‰\n4. ç‚’ç•ªèŒ„è‡³å‡ºæ±ï¼ˆ4åˆ†é’Ÿï¼‰\n5. åŠ ç³–ç›ç¿»ç‚’ï¼ˆ3åˆ†é’Ÿï¼‰",
        "alternatives": "ç•ªèŒ„â†’å½©æ¤’ï¼ˆ200å…‹ï¼‰\nç³–â†’ç•ªèŒ„é…±ï¼ˆ10å…‹ï¼‰",
        "nutrition": "çƒ­é‡220å¤§å¡ | è›‹ç™½è´¨12g | ç»´ç”Ÿç´ Cä¸°å¯Œ",
        "tips": "åŠ ç³–ä¸­å’Œé…¸å‘³"
    },
    "åœŸè±†ä¸ç‚’è‚‰": {
        "category": "ç‚’èœ",
        "time": "25åˆ†é’Ÿ",
        "img_url": "https://img1.doubanio.com/view/photo/l/public/s3435992041.jpg",
        "ingredients": [
            {"name": "åœŸè±†", "amount": "400å…‹"},
            {"name": "çŒªè‚‰", "amount": "150å…‹"},
            {"name": "é’æ¤’", "amount": "1ä¸ª"},
            {"name": "è’œ", "amount": "3ç“£"}
        ],
        "steps": "1. åœŸè±†åˆ‡ä¸æ³¡æ°´ï¼ˆ10åˆ†é’Ÿï¼‰\n2. çŒªè‚‰åˆ‡ä¸è…Œåˆ¶ï¼ˆ8åˆ†é’Ÿï¼‰\n3. ç‚’è‚‰ä¸è‡³å˜è‰²ï¼ˆ3åˆ†é’Ÿï¼‰\n4. åŠ åœŸè±†ä¸é’æ¤’ç¿»ç‚’ï¼ˆ5åˆ†é’Ÿï¼‰\n5. åŠ é†‹è°ƒå‘³ï¼ˆ2åˆ†é’Ÿï¼‰",
        "alternatives": "çŒªè‚‰â†’ç‰›è‚‰ï¼ˆ150å…‹ï¼‰",
        "nutrition": "çƒ­é‡280å¤§å¡ | ç¢³æ°´ä¸°å¯Œ",
        "tips": "åœŸè±†ä¸æ³¡æ°´åæ›´è„†"
    },
    "åœŸè±†çƒ§è‚‰": {
        "category": "ç‚’èœ",
        "time": "40åˆ†é’Ÿ",
        "img_url": "https://img9.doubanio.com/view/photo/l/public/s3435992042.jpg",
        "ingredients": [
            {"name": "åœŸè±†", "amount": "300å…‹"},
            {"name": "çŒªè‚‰", "amount": "200å…‹"},
            {"name": "å…«è§’", "amount": "1ä¸ª"},
            {"name": "ç”ŸæŠ½", "amount": "10æ¯«å‡"}
        ],
        "steps": "1. çŒªè‚‰åˆ‡å—ç„¯æ°´ï¼ˆ10åˆ†é’Ÿï¼‰\n2. åœŸè±†åˆ‡å—ç…è‡³é‡‘é»„ï¼ˆ8åˆ†é’Ÿï¼‰\n3. ç‚’é¦™å…«è§’åŠ çŒªè‚‰ç¿»ç‚’ï¼ˆ5åˆ†é’Ÿï¼‰\n4. åŠ ç”ŸæŠ½åŠ æ°´ç„–15åˆ†é’Ÿ\n5. åŠ åœŸè±†æ”¶æ±ï¼ˆ2åˆ†é’Ÿï¼‰",
        "alternatives": "çŒªè‚‰â†’äº”èŠ±è‚‰",
        "nutrition": "çƒ­é‡380å¤§å¡ | ä¸‹é¥­ç¥å™¨",
        "tips": "åœŸè±†åæ”¾æ›´è½¯ç³¯"
    },
    # è”¬èœæ³¥ç±»
    "èƒ¡èåœæ³¥": {
        "category": "è”¬èœæ³¥",
        "time": "30åˆ†é’Ÿ",
        "img_url": "https://img2.doubanio.com/view/photo/l/public/s3435992053.jpg",
        "ingredients": [
            {"name": "èƒ¡èåœ", "amount": "500å…‹"},
            {"name": "é»„æ²¹", "amount": "10å…‹"},
            {"name": "ç‰›å¥¶", "amount": "50æ¯«å‡"}
        ],
        "steps": "1. èƒ¡èåœå»çš®åˆ‡å—ï¼ˆ8åˆ†é’Ÿï¼‰\n2. è’¸20åˆ†é’Ÿè‡³è½¯çƒ‚\n3. åŠ ç‰›å¥¶æ‰“æˆæ³¥ï¼ˆ3åˆ†é’Ÿï¼‰\n4. åŠ é»„æ²¹ç›æ‹ŒåŒ€ï¼ˆ2åˆ†é’Ÿï¼‰\n5. è¿‡ç­›ï¼ˆ3åˆ†é’Ÿï¼‰",
        "alternatives": "èƒ¡èåœâ†’å—ç“œï¼ˆ500å…‹ï¼‰\né»„æ²¹â†’æ©„æ¦„æ²¹ï¼ˆ10æ¯«å‡ï¼‰",
        "nutrition": "çƒ­é‡150å¤§å¡ | Î²-èƒ¡èåœç´ ä¸°å¯Œ",
        "tips": "è’¸æ¯”ç…®ä¿ç•™è¥å…»"
    },
    "è èœåœŸè±†æ³¥": {
        "category": "è”¬èœæ³¥",
        "time": "40åˆ†é’Ÿ",
        "img_url": "https://img1.doubanio.com/view/photo/l/public/s3435992054.jpg",
        "ingredients": [
            {"name": "åœŸè±†", "amount": "400å…‹"},
            {"name": "è èœ", "amount": "200å…‹"},
            {"name": "ç‰›å¥¶", "amount": "100æ¯«å‡"}
        ],
        "steps": "1. åœŸè±†è’¸25åˆ†é’Ÿ\n2. è èœç„¯æ°´æŒ¤å¹²ï¼ˆ8åˆ†é’Ÿï¼‰\n3. åœŸè±†å‹æˆæ³¥ï¼ˆ5åˆ†é’Ÿï¼‰\n4. åŠ è èœç‰›å¥¶ï¼ˆ3åˆ†é’Ÿï¼‰\n5. æ…æ‹Œå‡åŒ€ï¼ˆ2åˆ†é’Ÿï¼‰",
        "alternatives": "è èœâ†’è¥¿å…°èŠ±ï¼ˆ200å…‹ï¼‰",
        "nutrition": "çƒ­é‡180å¤§å¡ | é“è´¨ä¸°å¯Œ",
        "tips": "è èœç„¯æ°´å»é™¤è‰é…¸"
    },
    # æ°´æœæ³¥ç±»
    "è‹¹æœæ³¥": {
        "category": "æ°´æœæ³¥",
        "time": "25åˆ†é’Ÿ",
        "img_url": "https://img9.doubanio.com/view/photo/l/public/s3435992055.jpg",
        "ingredients": [
            {"name": "è‹¹æœ", "amount": "3ä¸ª"},
            {"name": "æŸ æª¬æ±", "amount": "5æ¯«å‡"}
        ],
        "steps": "1. è‹¹æœå»çš®å»æ ¸åˆ‡å—ï¼ˆ5åˆ†é’Ÿï¼‰\n2. åŠ æ°´ç…®15åˆ†é’Ÿè‡³è½¯çƒ‚\n3. å‹æˆæ³¥ï¼ˆ3åˆ†é’Ÿï¼‰\n4. åŠ æŸ æª¬æ±é˜²æ°§åŒ–ï¼ˆ1åˆ†é’Ÿï¼‰",
        "alternatives": "è‹¹æœâ†’æ¢¨ï¼ˆ3ä¸ªï¼‰",
        "nutrition": "çƒ­é‡120å¤§å¡ | è†³é£Ÿçº¤ç»´ä¸°å¯Œ",
        "tips": "åŠ æŸ æª¬æ±é˜²å˜è‰²"
    },
    "é¦™è•‰ç‰›æ²¹æœæ³¥": {
        "category": "æ°´æœæ³¥",
        "time": "10åˆ†é’Ÿ",
        "img_url": "https://img2.doubanio.com/view/photo/l/public/s3435992056.jpg",
        "ingredients": [
            {"name": "é¦™è•‰", "amount": "2æ ¹"},
            {"name": "ç‰›æ²¹æœ", "amount": "1ä¸ª"},
            {"name": "èœ‚èœœ", "amount": "10å…‹"}
        ],
        "steps": "1. é¦™è•‰ç‰›æ²¹æœå»çš®ï¼ˆ5åˆ†é’Ÿï¼‰\n2. æ”¾å…¥æ–™ç†æœºï¼ˆ1åˆ†é’Ÿï¼‰\n3. åŠ èœ‚èœœæŸ æª¬æ±ï¼ˆ1åˆ†é’Ÿï¼‰\n4. æ‰“æˆç»†è…»æ³¥çŠ¶ï¼ˆ2åˆ†é’Ÿï¼‰",
        "alternatives": "ç‰›æ²¹æœâ†’å¸Œè…Šé…¸å¥¶ï¼ˆ100å…‹ï¼‰",
        "nutrition": "çƒ­é‡250å¤§å¡ | å¥åº·è„‚è‚ª",
        "tips": "ç‰›æ²¹æœé€‰ç†Ÿé€çš„"
    },

    # ========== è±†è…é¦™è‡ä¸“å±èœï¼ˆ3é“ï¼Œè¡¥å…¨img_urlï¼‰ ==========
    "é¦™è‡è±†è…ç„–é¥­": {
        "category": "é¥­ç±»",
        "time": "40åˆ†é’Ÿ",
        "img_url": "https://img2.doubanio.com/view/photo/l/public/s3435992045.jpg",
        "ingredients": [
            {"name": "å¤§ç±³", "amount": "200å…‹"},
            {"name": "é¦™è‡", "amount": "5æœµ"},
            {"name": "å«©è±†è…", "amount": "200å…‹"},
            {"name": "é’èœ", "amount": "50å…‹"}
        ],
        "steps": "1. é¦™è‡æ³¡å‘åˆ‡ä¸ï¼ˆ10åˆ†é’Ÿï¼‰\n2. è±†è…åˆ‡å—ç„¯æ°´ï¼ˆ5åˆ†é’Ÿï¼‰\n3. å¤§ç±³æ·˜æ´—æ”¾ç”µé¥­ç…²\n4. åŠ é¦™è‡è±†è…é’èœå’Œæ°´\n5. ç…®é¥­30åˆ†é’Ÿç„–5åˆ†é’Ÿ",
        "alternatives": "å«©è±†è…â†’è€è±†è…",
        "nutrition": "çƒ­é‡280å¤§å¡ | ç´ é£Ÿå‹å¥½",
        "tips": "è±†è…ç„¯æ°´é˜²ç¢"
    },
    "è±†è…é¦™è‡æ±¤": {
        "category": "æ±¤ç±»",
        "time": "25åˆ†é’Ÿ",
        "img_url": "https://img9.doubanio.com/view/photo/l/public/s3435992046.jpg",
        "ingredients": [
            {"name": "å«©è±†è…", "amount": "250å…‹"},
            {"name": "é¦™è‡", "amount": "4æœµ"},
            {"name": "é’èœ", "amount": "30å…‹"},
            {"name": "ç›", "amount": "3å…‹"}
        ],
        "steps": "1. é¦™è‡åˆ‡ç‰‡ï¼Œè±†è…åˆ‡å—ï¼ˆ5åˆ†é’Ÿï¼‰\n2. æ¸…æ°´çƒ§å¼€åŠ é¦™è‡ç…®10åˆ†é’Ÿ\n3. åŠ è±†è…ç…®5åˆ†é’Ÿ\n4. åŠ é’èœç›ç…®2åˆ†é’Ÿå‡ºé”…",
        "alternatives": "å«©è±†è…â†’å†»è±†è…",
        "nutrition": "çƒ­é‡90å¤§å¡ | ä½å¡ä½è„‚",
        "tips": "å‡ºé”…å‰åŠ é¦™æ²¹æ›´é¦™"
    },
    "é¦™è‡è±†è…ç‚’é’èœ": {
        "category": "ç‚’èœ",
        "time": "20åˆ†é’Ÿ",
        "img_url": "https://img1.doubanio.com/view/photo/l/public/s3435992047.jpg",
        "ingredients": [
            {"name": "é¦™è‡", "amount": "6æœµ"},
            {"name": "åŒ—è±†è…", "amount": "300å…‹"},
            {"name": "ä¸Šæµ·é’", "amount": "200å…‹"},
            {"name": "èšæ²¹", "amount": "10æ¯«å‡"}
        ],
        "steps": "1. é¦™è‡åˆ‡ç‰‡ç„¯æ°´ï¼ˆ5åˆ†é’Ÿï¼‰\n2. è±†è…åˆ‡å—ç…è‡³ä¸¤é¢é‡‘é»„ï¼ˆ8åˆ†é’Ÿï¼‰\n3. ç‚’é’èœè‡³æ–­ç”Ÿï¼ˆ3åˆ†é’Ÿï¼‰\n4. åŠ é¦™è‡è±†è…èšæ²¹ç¿»ç‚’ï¼ˆ3åˆ†é’Ÿï¼‰\n5. åŠ ç›è°ƒå‘³å‡ºé”…ï¼ˆ1åˆ†é’Ÿï¼‰",
        "alternatives": "ä¸Šæµ·é’â†’æ²¹éº¦èœ",
        "nutrition": "çƒ­é‡150å¤§å¡ | ä½è„‚é«˜çº¤ç»´",
        "tips": "è±†è…ç…å®šå‹å†ç¿»ç‚’"
    },

    # ========== æ— å†²çªåŸºç¡€èœï¼ˆ2é“ï¼Œè¡¥å…¨img_urlï¼‰ ==========
    "è™¾ä»è¥¿å…°èŠ±ç‚’ç™¾åˆ": {
        "category": "ç‚’èœ",
        "time": "15åˆ†é’Ÿ",
        "img_url": "https://img2.doubanio.com/view/photo/l/public/s3435992057.jpg",
        "ingredients": [
            {"name": "è™¾ä»", "amount": "150å…‹"},
            {"name": "è¥¿å…°èŠ±", "amount": "200å…‹"},
            {"name": "ç™¾åˆ", "amount": "100å…‹"},
            {"name": "è’œæœ«", "amount": "10å…‹"}
        ],
        "steps": "1. è™¾ä»è…Œåˆ¶ï¼ˆ5åˆ†é’Ÿï¼‰\n2. è¥¿å…°èŠ±ç„¯æ°´ï¼ˆ3åˆ†é’Ÿï¼‰\n3. ç‚’é¦™è’œæœ«åŠ è™¾ä»ç¿»ç‚’ï¼ˆ3åˆ†é’Ÿï¼‰\n4. åŠ è¥¿å…°èŠ±ç™¾åˆç¿»ç‚’ï¼ˆ3åˆ†é’Ÿï¼‰\n5. åŠ ç›è°ƒå‘³ï¼ˆ1åˆ†é’Ÿï¼‰",
        "alternatives": "ç™¾åˆâ†’æœ¨è€³",
        "nutrition": "çƒ­é‡180å¤§å¡ | é«˜è›‹ç™½ä½å¡",
        "tips": "è¥¿å…°èŠ±ç„¯æ°´åŠ å°‘è®¸ç›æ›´ç»¿"
    },
    "ç´«è–¯é“¶è€³ç¾¹": {
        "category": "ç”œç‚¹",
        "time": "60åˆ†é’Ÿ",
        "img_url": "https://img9.doubanio.com/view/photo/l/public/s3435992058.jpg",
        "ingredients": [
            {"name": "ç´«è–¯", "amount": "200å…‹"},
            {"name": "é“¶è€³", "amount": "1æœµ"},
            {"name": "å†°ç³–", "amount": "30å…‹"},
            {"name": "çº¢æ£", "amount": "5é¢—"}
        ],
        "steps": "1. é“¶è€³æ³¡å‘æ’•å°æœµï¼ˆ15åˆ†é’Ÿï¼‰\n2. ç´«è–¯å»çš®åˆ‡å—ï¼ˆ5åˆ†é’Ÿï¼‰\n3. é“¶è€³åŠ æ°´ç…®30åˆ†é’Ÿ\n4. åŠ ç´«è–¯çº¢æ£ç…®10åˆ†é’Ÿ\n5. åŠ å†°ç³–ç…®5åˆ†é’Ÿ",
        "alternatives": "å†°ç³–â†’èœ‚èœœ",
        "nutrition": "çƒ­é‡200å¤§å¡ | æ»‹é˜´æ¶¦ç‡¥",
        "tips": "é“¶è€³ç…®è‡³å‡ºèƒ¶å£æ„Ÿæ›´å¥½"
    },

    # ========== æ–°å¢èœå‰13é“ï¼ˆè¡¥å…¨img_urlï¼‰ ==========
    # æ±¤ç±»ï¼ˆæ–°å¢5é“é‡Œçš„å‰5é“ï¼‰
    "å†¬ç“œæµ·å¸¦æ’éª¨æ±¤": {
        "category": "æ±¤ç±»",
        "time": "80åˆ†é’Ÿ",
        "img_url": "https://img1.doubanio.com/view/photo/l/public/s3435992059.jpg",
        "ingredients": [
            {"name": "æ’éª¨", "amount": "400å…‹"},
            {"name": "å†¬ç“œ", "amount": "300å…‹"},
            {"name": "æµ·å¸¦", "amount": "100å…‹"},
            {"name": "å§œç‰‡", "amount": "15å…‹"}
        ],
        "steps": "1. æ’éª¨ç„¯æ°´å»è¡€æ²«ï¼ˆ10åˆ†é’Ÿï¼‰\n2. æµ·å¸¦æ³¡å‘åˆ‡æ®µï¼ˆ5åˆ†é’Ÿï¼‰\n3. æ’éª¨+å§œç‰‡ç‚–60åˆ†é’Ÿ\n4. åŠ å†¬ç“œæµ·å¸¦ç…®10åˆ†é’Ÿ\n5. åŠ ç›è°ƒå‘³ï¼ˆ2åˆ†é’Ÿï¼‰",
        "alternatives": "æ’éª¨â†’è…”éª¨ï¼ˆ400å…‹ï¼‰",
        "nutrition": "çƒ­é‡220å¤§å¡ | è¡¥ç¢˜è¡¥é’™",
        "tips": "å†¬ç“œæœ€åæ”¾ï¼Œé¿å…ç…®çƒ‚"
    },
    "å±±è¯é¸½å­æ±¤": {
        "category": "æ±¤ç±»",
        "time": "120åˆ†é’Ÿ",
        "img_url": "https://img2.doubanio.com/view/photo/l/public/s3435992060.jpg",
        "ingredients": [
            {"name": "é¸½å­", "amount": "1åª"},
            {"name": "å±±è¯", "amount": "200å…‹"},
            {"name": "çº¢æ£", "amount": "6é¢—"},
            {"name": "æ¸æ", "amount": "10å…‹"}
        ],
        "steps": "1. é¸½å­ç„¯æ°´ï¼ˆ10åˆ†é’Ÿï¼‰\n2. å±±è¯å»çš®åˆ‡å—ï¼ˆ5åˆ†é’Ÿï¼‰\n3. é¸½å­+çº¢æ£ç‚–90åˆ†é’Ÿ\n4. åŠ å±±è¯ç…®20åˆ†é’Ÿ\n5. åŠ æ¸æç›è°ƒå‘³ï¼ˆ3åˆ†é’Ÿï¼‰",
        "alternatives": "é¸½å­â†’è€æ¯é¸¡åŠåª",
        "nutrition": "çƒ­é‡350å¤§å¡ | è¡¥æ°”å…»è¡€",
        "tips": "å±±è¯å»çš®æˆ´æ‰‹å¥—ï¼Œé¿å…è¿‡æ•"
    },
    "ä¸ç“œé¸¡è›‹æ±¤": {
        "category": "æ±¤ç±»",
        "time": "15åˆ†é’Ÿ",
        "img_url": "https://img9.doubanio.com/view/photo/l/public/s3435992061.jpg",
        "ingredients": [
            {"name": "ä¸ç“œ", "amount": "250å…‹"},
            {"name": "é¸¡è›‹", "amount": "2ä¸ª"},
            {"name": "è™¾çš®", "amount": "10å…‹"},
            {"name": "ç›", "amount": "3å…‹"}
        ],
        "steps": "1. ä¸ç“œå»çš®åˆ‡æ»šåˆ€å—ï¼ˆ3åˆ†é’Ÿï¼‰\n2. é¸¡è›‹æ‰“æ•£ï¼ˆ1åˆ†é’Ÿï¼‰\n3. æ¸…æ°´çƒ§å¼€åŠ ä¸ç“œç…®5åˆ†é’Ÿ\n4. æ·‹å…¥è›‹æ¶²ç…®2åˆ†é’Ÿ\n5. åŠ è™¾çš®ç›è°ƒå‘³ï¼ˆ1åˆ†é’Ÿï¼‰",
        "alternatives": "è™¾çš®â†’ç´«èœï¼ˆ5å…‹ï¼‰",
        "nutrition": "çƒ­é‡110å¤§å¡ | æ¸…çƒ­è§£æš‘",
        "tips": "ä¸ç“œåˆ«ç…®å¤ªä¹…ï¼Œä¿æŒè„†å«©"
    },
    "è²è—•èŠ±ç”ŸçŒªéª¨æ±¤": {
        "category": "æ±¤ç±»",
        "time": "100åˆ†é’Ÿ",
        "img_url": "https://img1.doubanio.com/view/photo/l/public/s3435992062.jpg",
        "ingredients": [
            {"name": "çŒªéª¨", "amount": "500å…‹"},
            {"name": "è²è—•", "amount": "300å…‹"},
            {"name": "èŠ±ç”Ÿ", "amount": "50å…‹"},
            {"name": "é™ˆçš®", "amount": "1ç‰‡"}
        ],
        "steps": "1. çŒªéª¨ç„¯æ°´ï¼ˆ10åˆ†é’Ÿï¼‰\n2. è²è—•åˆ‡å—ã€èŠ±ç”Ÿæ³¡å‘ï¼ˆ5åˆ†é’Ÿï¼‰\n3. æ‰€æœ‰ææ–™ç‚–90åˆ†é’Ÿ\n4. åŠ ç›è°ƒå‘³ï¼ˆ2åˆ†é’Ÿï¼‰",
        "alternatives": "çŒªéª¨â†’é¾™éª¨ï¼ˆ500å…‹ï¼‰",
        "nutrition": "çƒ­é‡290å¤§å¡ | å¥è„¾å…»èƒƒ",
        "tips": "è²è—•é€‰ç²‰è—•ï¼Œç‚–å‡ºæ¥æ›´ç»µ"
    },
    "ç´«èœè›‹èŠ±æ±¤": {
        "category": "æ±¤ç±»",
        "time": "10åˆ†é’Ÿ",
        "img_url": "https://img2.doubanio.com/view/photo/l/public/s3435992063.jpg",
        "ingredients": [
            {"name": "ç´«èœ", "amount": "10å…‹"},
            {"name": "é¸¡è›‹", "amount": "1ä¸ª"},
            {"name": "è‘±èŠ±", "amount": "5å…‹"},
            {"name": "é¦™æ²¹", "amount": "5æ¯«å‡"}
        ],
        "steps": "1. ç´«èœå†²æ´—å¹²å‡€ï¼ˆ1åˆ†é’Ÿï¼‰\n2. é¸¡è›‹æ‰“æ•£ï¼ˆ1åˆ†é’Ÿï¼‰\n3. æ¸…æ°´çƒ§å¼€åŠ ç´«èœç…®3åˆ†é’Ÿ\n4. æ·‹å…¥è›‹æ¶²ç…®1åˆ†é’Ÿ\n5. åŠ è‘±èŠ±é¦™æ²¹ç›è°ƒå‘³ï¼ˆ1åˆ†é’Ÿï¼‰",
        "alternatives": "ç´«èœâ†’æµ·å¸¦ä¸ï¼ˆ50å…‹ï¼‰",
        "nutrition": "çƒ­é‡80å¤§å¡ | è¡¥ç¢˜è¡¥é“",
        "tips": "è›‹æ¶²æ·‹å…¥æ—¶æ…æ‹Œï¼Œè›‹èŠ±æ›´å‡åŒ€"
    },
    # ç²¥ç±»ï¼ˆæ–°å¢4é“é‡Œçš„å‰4é“ï¼‰
    "ç‡•éº¦çº¢æ£ç²¥": {
        "category": "ç²¥ç±»",
        "time": "30åˆ†é’Ÿ",
        "img_url": "https://img9.doubanio.com/view/photo/l/public/s3435992064.jpg",
        "ingredients": [
            {"name": "ç‡•éº¦ç‰‡", "amount": "80å…‹"},
            {"name": "çº¢æ£", "amount": "8é¢—"},
            {"name": "æ¡‚åœ†", "amount": "10é¢—"},
            {"name": "å†°ç³–", "amount": "15å…‹"}
        ],
        "steps": "1. çº¢æ£æ¡‚åœ†å»æ ¸ï¼ˆ3åˆ†é’Ÿï¼‰\n2. ç‡•éº¦ç‰‡æ·˜æ´—ï¼ˆ1åˆ†é’Ÿï¼‰\n3. åŠ æ°´ç…®20åˆ†é’Ÿ\n4. åŠ çº¢æ£æ¡‚åœ†ç…®5åˆ†é’Ÿ\n5. åŠ å†°ç³–è°ƒå‘³ï¼ˆ2åˆ†é’Ÿï¼‰",
        "alternatives": "ç‡•éº¦ç‰‡â†’è—œéº¦ï¼ˆ80å…‹ï¼‰",
        "nutrition": "çƒ­é‡190å¤§å¡ | è¡¥è¡€å®‰ç¥",
        "tips": "ç‡•éº¦é€‰çº¯ç‡•éº¦ï¼Œå£æ„Ÿæ›´ç¨ "
    },
    "ç»¿è±†ç™¾åˆç²¥": {
        "category": "ç²¥ç±»",
        "time": "60åˆ†é’Ÿ",
        "img_url": "https://img1.doubanio.com/view/photo/l/public/s3435992065.jpg",
        "ingredients": [
            {"name": "ç»¿è±†", "amount": "50å…‹"},
            {"name": "å¤§ç±³", "amount": "50å…‹"},
            {"name": "ç™¾åˆ", "amount": "30å…‹"},
            {"name": "å†°ç³–", "amount": "20å…‹"}
        ],
        "steps": "1. ç»¿è±†æå‰æµ¸æ³¡30åˆ†é’Ÿ\n2. ç™¾åˆæ³¡å‘ï¼ˆ5åˆ†é’Ÿï¼‰\n3. ç»¿è±†+å¤§ç±³ç…®40åˆ†é’Ÿ\n4. åŠ ç™¾åˆç…®10åˆ†é’Ÿ\n5. åŠ å†°ç³–è°ƒå‘³ï¼ˆ2åˆ†é’Ÿï¼‰",
        "alternatives": "ç»¿è±†â†’çº¢è±†ï¼ˆ50å…‹ï¼‰",
        "nutrition": "çƒ­é‡170å¤§å¡ | æ¸…çƒ­é™ç«",
        "tips": "ç»¿è±†æ³¡å‘åç…®æ›´å¿«è½¯çƒ‚"
    },
    "å±±è¯å°ç±³ç²¥": {
        "category": "ç²¥ç±»",
        "time": "40åˆ†é’Ÿ",
        "img_url": "https://img2.doubanio.com/view/photo/l/public/s3435992066.jpg",
        "ingredients": [
            {"name": "å°ç±³", "amount": "80å…‹"},
            {"name": "å±±è¯", "amount": "150å…‹"},
            {"name": "çº¢æ£", "amount": "5é¢—"},
            {"name": "æ¸æ", "amount": "5å…‹"}
        ],
        "steps": "1. å±±è¯å»çš®åˆ‡ä¸ï¼ˆ5åˆ†é’Ÿï¼‰\n2. å°ç±³æ·˜æ´—ï¼ˆ1åˆ†é’Ÿï¼‰\n3. å°ç±³ç…®20åˆ†é’Ÿ\n4. åŠ å±±è¯çº¢æ£ç…®15åˆ†é’Ÿ\n5. åŠ æ¸æç›è°ƒå‘³ï¼ˆ1åˆ†é’Ÿï¼‰",
        "alternatives": "å±±è¯â†’å—ç“œï¼ˆ150å…‹ï¼‰",
        "nutrition": "çƒ­é‡160å¤§å¡ | å¥è„¾å…»èƒƒ",
        "tips": "å±±è¯ä¸åˆ‡å°ï¼Œæ›´å®¹æ˜“ç…®çƒ‚"
    },
    "é»‘ç±³ç²¥": {
        "category": "ç²¥ç±»",
        "time": "90åˆ†é’Ÿ",
        "img_url": "https://img9.doubanio.com/view/photo/l/public/s3435992067.jpg",
        "ingredients": [
            {"name": "é»‘ç±³", "amount": "100å…‹"},
            {"name": "ç³¯ç±³", "amount": "50å…‹"},
            {"name": "æ ¸æ¡ƒ", "amount": "30å…‹"},
            {"name": "å†°ç³–", "amount": "20å…‹"}
        ],
        "steps": "1. é»‘ç±³ç³¯ç±³æå‰æµ¸æ³¡60åˆ†é’Ÿ\n2. æ ¸æ¡ƒæ°ç¢ï¼ˆ2åˆ†é’Ÿï¼‰\n3. æ‰€æœ‰ææ–™ç…®80åˆ†é’Ÿ\n4. åŠ å†°ç³–è°ƒå‘³ï¼ˆ3åˆ†é’Ÿï¼‰",
        "alternatives": "æ ¸æ¡ƒâ†’èŠ±ç”Ÿï¼ˆ30å…‹ï¼‰",
        "nutrition": "çƒ­é‡280å¤§å¡ | è¡¥è‚¾ç›Šè„‘",
        "tips": "é»‘ç±³éš¾ç…®ï¼Œæµ¸æ³¡æ—¶é—´è¦è¶³å¤Ÿ"
    },
    # é¥­ç±»ï¼ˆæ–°å¢4é“é‡Œçš„å‰4é“ï¼‰
    "è…Šè‚ ç…²ä»”é¥­": {
        "category": "é¥­ç±»",
        "time": "50åˆ†é’Ÿ",
        "img_url": "https://img1.doubanio.com/view/photo/l/public/s3435992068.jpg",
        "ingredients": [
            {"name": "å¤§ç±³", "amount": "200å…‹"},
            {"name": "è…Šè‚ ", "amount": "100å…‹"},
            {"name": "é’èœ", "amount": "2é¢—"},
            {"name": "ç”ŸæŠ½", "amount": "10æ¯«å‡"}
        ],
        "steps": "1. å¤§ç±³æå‰æµ¸æ³¡30åˆ†é’Ÿ\n2. è…Šè‚ åˆ‡ç‰‡ï¼ˆ2åˆ†é’Ÿï¼‰\n3. å¤§ç±³åŠ æ°´ç…®20åˆ†é’Ÿ\n4. é“ºè…Šè‚ ç„–10åˆ†é’Ÿ\n5. é’èœç„¯æ°´æ‘†ç›˜ï¼Œæ·‹ç”ŸæŠ½ï¼ˆ2åˆ†é’Ÿï¼‰",
        "alternatives": "è…Šè‚ â†’è…Šè‚‰ï¼ˆ100å…‹ï¼‰",
        "nutrition": "çƒ­é‡380å¤§å¡ | å’¸é¦™å…¥å‘³",
        "tips": "ç…®é¥­æ°´é‡æ¯”å¹³æ—¶å°‘ï¼Œé¿å…è½¯çƒ‚"
    },
    "å’–å–±é¸¡è‚‰é¥­": {
        "category": "é¥­ç±»",
        "time": "40åˆ†é’Ÿ",
        "img_url": "https://img2.doubanio.com/view/photo/l/public/s3435992069.jpg",
        "ingredients": [
            {"name": "ç±³é¥­", "amount": "300å…‹"},
            {"name": "é¸¡èƒ¸è‚‰", "amount": "200å…‹"},
            {"name": "å’–å–±å—", "amount": "50å…‹"},
            {"name": "èƒ¡èåœ", "amount": "50å…‹"}
        ],
        "steps": "1. é¸¡èƒ¸è‚‰èƒ¡èåœåˆ‡ä¸ï¼ˆ5åˆ†é’Ÿï¼‰\n2. ç‚’é¦™é¸¡èƒ¸è‚‰ï¼ˆ3åˆ†é’Ÿï¼‰\n3. åŠ èƒ¡èåœ+æ¸…æ°´ç…®10åˆ†é’Ÿ\n4. åŠ å’–å–±å—ç…®5åˆ†é’Ÿ\n5. æµ‡åœ¨ç±³é¥­ä¸Šï¼ˆ2åˆ†é’Ÿï¼‰",
        "alternatives": "é¸¡èƒ¸è‚‰â†’é¸¡è…¿è‚‰ï¼ˆ200å…‹ï¼‰",
        "nutrition": "çƒ­é‡420å¤§å¡ | æµ“éƒé²œé¦™",
        "tips": "å’–å–±å—ç…®è‡³èåŒ–å³å¯ï¼Œåˆ«ç…®å¤ªä¹…"
    },
    "è èç‚’é¥­": {
        "category": "é¥­ç±»",
        "time": "25åˆ†é’Ÿ",
        "img_url": "https://img9.doubanio.com/view/photo/l/public/s3435992070.jpg",
        "ingredients": [
            {"name": "ç±³é¥­", "amount": "300å…‹"},
            {"name": "è è", "amount": "150å…‹"},
            {"name": "è™¾ä»", "amount": "80å…‹"},
            {"name": "é’è±†", "amount": "30å…‹"}
        ],
        "steps": "1. è èåˆ‡ä¸ã€è™¾ä»è…Œåˆ¶ï¼ˆ5åˆ†é’Ÿï¼‰\n2. ç‚’é¦™è™¾ä»é’è±†ï¼ˆ3åˆ†é’Ÿï¼‰\n3. åŠ ç±³é¥­ç¿»ç‚’5åˆ†é’Ÿ\n4. åŠ è èä¸ç¿»ç‚’2åˆ†é’Ÿ\n5. åŠ ç›è°ƒå‘³ï¼ˆ1åˆ†é’Ÿï¼‰",
        "alternatives": "è™¾ä»â†’ç«è…¿ä¸ï¼ˆ80å…‹ï¼‰",
        "nutrition": "çƒ­é‡360å¤§å¡ | é…¸ç”œå¼€èƒƒ",
        "tips": "è èæœ€åæ”¾ï¼Œé¿å…ç‚’è½¯"
    },
    "è±†è§’ç„–é¥­": {
        "category": "é¥­ç±»",
        "time": "45åˆ†é’Ÿ",
        "img_url": "https://img1.doubanio.com/view/photo/l/public/s3435992071.jpg",
        "ingredients": [
            {"name": "å¤§ç±³", "amount": "200å…‹"},
            {"name": "è±†è§’", "amount": "150å…‹"},
            {"name": "è…Šè‚ ", "amount": "80å…‹"},
            {"name": "è€æŠ½", "amount": "5æ¯«å‡"}
        ],
        "steps": "1. è±†è§’åˆ‡æ®µã€è…Šè‚ åˆ‡ç‰‡ï¼ˆ5åˆ†é’Ÿï¼‰\n2. ç‚’é¦™è…Šè‚ è±†è§’ï¼ˆ3åˆ†é’Ÿï¼‰\n3. åŠ è€æŠ½ç¿»ç‚’1åˆ†é’Ÿ\n4. å’Œå¤§ç±³ä¸€èµ·ç…®25åˆ†é’Ÿ\n5. ç„–5åˆ†é’Ÿï¼ˆ2åˆ†é’Ÿï¼‰",
        "alternatives": "è…Šè‚ â†’ç‰›è‚‰ä¸ï¼ˆ80å…‹ï¼‰",
        "nutrition": "çƒ­é‡390å¤§å¡ | å’¸é¦™ä¸‹é¥­",
        "tips": "è±†è§’è¦ç‚’ç†Ÿï¼Œé¿å…ä¸­æ¯’"
    }
}

# ========== é£Ÿæè¯†åˆ«å‡½æ•° ==========
def recognize_ingredients(text):
    text_lower = text.strip().lower()
    ingredient_keywords = {
        "è±†è…": ["è±†è…"], "é¦™è‡": ["é¦™è‡"], "ç•ªèŒ„": ["ç•ªèŒ„", "è¥¿çº¢æŸ¿"],
        "é¸¡è›‹": ["é¸¡è›‹"], "åœŸè±†": ["åœŸè±†"], "çŒªè‚‰": ["çŒªè‚‰"],
        "è™¾ä»": ["è™¾ä»"], "ç´«è–¯": ["ç´«è–¯"]
    }
    recognized = []
    for ing, keywords in ingredient_keywords.items():
        for kw in keywords:
            if kw in text_lower:
                recognized.append(ing)
                break
    return list(set(recognized))

# ========== é¡µé¢å¸ƒå±€ ==========
st.title("ğŸ³ å…¨èƒ½å¨ç¥åŠ©æ‰‹ï¼ˆç¬¬ä¸€éƒ¨åˆ†ï¼š30é“èœï¼‰")
st.markdown("### åŒ…å«åŸºç¡€èœã€è±†è…é¦™è‡èœã€æ–°å¢å‰13é“")

with st.sidebar:
    st.header("ğŸ¥¦ é£Ÿæè¾“å…¥")
    user_input = st.text_input("è¾“å…¥é£Ÿæï¼ˆå¦‚ï¼šç•ªèŒ„é¸¡è›‹ï¼‰", "ç•ªèŒ„é¸¡è›‹")
    st.header("ğŸ½ï¸ èœè°±ç±»å‹")
    categories = ["æ±¤ç±»", "ç²¥ç±»", "é¥­ç±»", "ç‚’èœ", "è”¬èœæ³¥", "æ°´æœæ³¥", "ç”œç‚¹", "å…¨éƒ¨"]
    selected_cats = st.multiselect("é€‰æ‹©ç±»å‹", categories, default=["å…¨éƒ¨"])
    st.header("â±ï¸ æ—¶é—´è¦æ±‚")
    max_time = st.slider("æœ€å¤§åˆ¶ä½œæ—¶é—´ï¼ˆåˆ†é’Ÿï¼‰", 10, 120, 60)
    search_btn = st.button("ğŸ” æœç´¢èœè°±", type="primary", use_container_width=True)

# ========== æœç´¢é€»è¾‘ ==========
if search_btn:
    recognized = recognize_ingredients(user_input)
    if recognized:
        st.success(f"âœ… è¯†åˆ«é£Ÿæï¼š{', '.join(recognized)}")
        filtered = []
        for name, rec in RECIPES.items():
            ing_list = [i['name'] for i in rec['ingredients']]
            if not any(ing in ing_list for ing in recognized):
                continue
            if "å…¨éƒ¨" not in selected_cats and rec['category'] not in selected_cats:
                continue
            if int(rec['time'].split("åˆ†é’Ÿ")[0]) > max_time:
                continue
            filtered.append((name, rec))
        if filtered:
            for name, rec in filtered:
                with st.expander(f"ğŸ² {name} | {rec['category']} | {rec['time']}", expanded=True):
                    col1, col2 = st.columns([1, 2])
                    with col1:
                        st.image(load_image_from_url(rec['img_url']), caption=name, use_column_width=True)
                    with col2:
                        st.markdown("**ğŸ¥— é£Ÿææ¸…å•**")
                        for ing in rec['ingredients']:
                            st.write(f"- {ing['name']}ï¼š{ing['amount']}")
                        st.markdown("**ğŸ‘¨â€ğŸ³ åˆ¶ä½œæ­¥éª¤**")
                        st.write(rec['steps'])
                        st.markdown(f"**ğŸ’¡ å°è´´å£«**ï¼š{rec['tips']}")
                        st.markdown(f"**ğŸ“Š è¥å…»å‚è€ƒ**ï¼š{rec['nutrition']}")
                        if rec.get('alternatives'):
                            st.markdown(f"**ğŸ”„ æ›¿ä»£æ–¹æ¡ˆ**ï¼š{rec['alternatives']}")
        else:
            st.warning("âš ï¸ æš‚æ— åŒ¹é…çš„èœè°±")
    else:
        st.error("âŒ æœªè¯†åˆ«åˆ°æœ‰æ•ˆé£Ÿæï¼Œè¯·é‡æ–°è¾“å…¥")


# ========== èœè°±æ•°æ®åº“ï¼ˆç¬¬äºŒéƒ¨åˆ†ï¼š10é“èœï¼‰ ==========
RECIPES = {
    # ========== æ–°å¢èœå10é“ï¼ˆè¡¥å…¨img_urlï¼‰ ==========
    # ç‚’èœç±»ï¼ˆæ–°å¢8é“é‡Œçš„å6é“ï¼‰
    "æ¸…ç‚’è¥¿å…°èŠ±": {
        "category": "ç‚’èœ",
        "time": "10åˆ†é’Ÿ",
        "img_url": "https://img2.doubanio.com/view/photo/l/public/s3435992072.jpg",
        "ingredients": [
            {"name": "è¥¿å…°èŠ±", "amount": "300å…‹"},
            {"name": "è’œæœ«", "amount": "10å…‹"},
            {"name": "ç›", "amount": "3å…‹"},
            {"name": "èšæ²¹", "amount": "5æ¯«å‡"}
        ],
        "steps": "1. è¥¿å…°èŠ±åˆ‡å°æœµç„¯æ°´ï¼ˆ3åˆ†é’Ÿï¼‰\n2. çƒ­æ²¹çˆ†é¦™è’œæœ«ï¼ˆ1åˆ†é’Ÿï¼‰\n3. åŠ è¥¿å…°èŠ±ç¿»ç‚’3åˆ†é’Ÿ\n4. åŠ èšæ²¹ç›è°ƒå‘³ï¼ˆ1åˆ†é’Ÿï¼‰",
        "alternatives": "è¥¿å…°èŠ±â†’èœèŠ±ï¼ˆ300å…‹ï¼‰",
        "nutrition": "çƒ­é‡70å¤§å¡ | å¯Œå«è†³é£Ÿçº¤ç»´",
        "tips": "ç„¯æ°´åŠ å°‘è®¸ç›ï¼Œè¥¿å…°èŠ±æ›´ç»¿"
    },
    "è’œè“‰å¨ƒå¨ƒèœ": {
        "category": "ç‚’èœ",
        "time": "10åˆ†é’Ÿ",
        "img_url": "https://img9.doubanio.com/view/photo/l/public/s3435992073.jpg",
        "ingredients": [
            {"name": "å¨ƒå¨ƒèœ", "amount": "2é¢—"},
            {"name": "è’œæœ«", "amount": "15å…‹"},
            {"name": "ç”ŸæŠ½", "amount": "5æ¯«å‡"},
            {"name": "ç³–", "amount": "2å…‹"}
        ],
        "steps": "1. å¨ƒå¨ƒèœåˆ‡æ¡ï¼ˆ2åˆ†é’Ÿï¼‰\n2. çƒ­æ²¹çˆ†é¦™è’œæœ«ï¼ˆ1åˆ†é’Ÿï¼‰\n3. åŠ å¨ƒå¨ƒèœç¿»ç‚’4åˆ†é’Ÿ\n4. åŠ ç”ŸæŠ½ç³–ç›è°ƒå‘³ï¼ˆ1åˆ†é’Ÿï¼‰",
        "alternatives": "å¨ƒå¨ƒèœâ†’å°ç™½èœï¼ˆ2é¢—ï¼‰",
        "nutrition": "çƒ­é‡60å¤§å¡ | æ¸…çˆ½è§£è…»",
        "tips": "å¨ƒå¨ƒèœç‚’è½¯å³å¯ï¼Œä¿ç•™æ°´åˆ†"
    },
    "é’æ¤’ç‚’é¸¡è…¿è‚‰": {
        "category": "ç‚’èœ",
        "time": "15åˆ†é’Ÿ",
        "img_url": "https://img1.doubanio.com/view/photo/l/public/s3435992074.jpg",
        "ingredients": [
            {"name": "é¸¡è…¿è‚‰", "amount": "200å…‹"},
            {"name": "é’æ¤’", "amount": "2ä¸ª"},
            {"name": "å§œç‰‡", "amount": "5å…‹"},
            {"name": "æ–™é…’", "amount": "5æ¯«å‡"}
        ],
        "steps": "1. é¸¡è…¿è‚‰åˆ‡ä¸è…Œåˆ¶ï¼ˆ5åˆ†é’Ÿï¼‰\n2. é’æ¤’åˆ‡å—ï¼ˆ2åˆ†é’Ÿï¼‰\n3. ç‚’é¦™å§œç‰‡+é¸¡è…¿è‚‰ï¼ˆ3åˆ†é’Ÿï¼‰\n4. åŠ é’æ¤’ç¿»ç‚’3åˆ†é’Ÿ\n5. åŠ ç›è°ƒå‘³ï¼ˆ1åˆ†é’Ÿï¼‰",
        "alternatives": "é¸¡è…¿è‚‰â†’é¸¡èƒ¸è‚‰ï¼ˆ200å…‹ï¼‰",
        "nutrition": "çƒ­é‡250å¤§å¡ | ä½è„‚é«˜è›‹ç™½",
        "tips": "é¸¡è…¿è‚‰åˆ«ç‚’å¤ªä¹…ï¼Œé¿å…æŸ´ç¡¬"
    },
    "æ¸…ç‚’è·å…°è±†": {
        "category": "ç‚’èœ",
        "time": "8åˆ†é’Ÿ",
        "img_url": "https://img2.doubanio.com/view/photo/l/public/s3435992075.jpg",
        "ingredients": [
            {"name": "è·å…°è±†", "amount": "250å…‹"},
            {"name": "è’œæœ«", "amount": "8å…‹"},
            {"name": "ç›", "amount": "2å…‹"},
            {"name": "é¦™æ²¹", "amount": "3æ¯«å‡"}
        ],
        "steps": "1. è·å…°è±†å»ç­‹æ´—å‡€ï¼ˆ2åˆ†é’Ÿï¼‰\n2. çƒ­æ²¹çˆ†é¦™è’œæœ«ï¼ˆ1åˆ†é’Ÿï¼‰\n3. åŠ è·å…°è±†ç¿»ç‚’4åˆ†é’Ÿ\n4. åŠ ç›é¦™æ²¹è°ƒå‘³ï¼ˆ1åˆ†é’Ÿï¼‰",
        "alternatives": "è·å…°è±†â†’å››å­£è±†ï¼ˆ250å…‹ï¼‰",
        "nutrition": "çƒ­é‡80å¤§å¡ | è„†å«©çˆ½å£",
        "tips": "è·å…°è±†ç‚’è‡³æ–­ç”Ÿå³å¯ï¼Œåˆ«ç‚’è€"
    },
    "è’œè“‰è’¸è™¾": {
        "category": "ç‚’èœ",
        "time": "15åˆ†é’Ÿ",
        "img_url": "https://img9.doubanio.com/view/photo/l/public/s3435992076.jpg",
        "ingredients": [
            {"name": "åŸºå›´è™¾", "amount": "300å…‹"},
            {"name": "è’œæœ«", "amount": "20å…‹"},
            {"name": "ç”ŸæŠ½", "amount": "10æ¯«å‡"},
            {"name": "ç²‰ä¸", "amount": "50å…‹"}
        ],
        "steps": "1. è™¾å¼€èƒŒå»çº¿ã€ç²‰ä¸æ³¡å‘ï¼ˆ5åˆ†é’Ÿï¼‰\n2. é“ºç²‰ä¸+è™¾ï¼Œæ’’è’œæœ«ç”ŸæŠ½ï¼ˆ2åˆ†é’Ÿï¼‰\n3. è’¸é”…ä¸Šæ±½è’¸8åˆ†é’Ÿ\n4. æ·‹çƒ­æ²¹ï¼ˆ1åˆ†é’Ÿï¼‰",
        "alternatives": "åŸºå›´è™¾â†’æ˜è™¾ï¼ˆ300å…‹ï¼‰",
        "nutrition": "çƒ­é‡220å¤§å¡ | é²œé¦™å‘³ç¾",
        "tips": "è’¸åˆ¶æ—¶é—´åˆ«è¶…8åˆ†é’Ÿï¼Œè™¾è€å½±å“å£æ„Ÿ"
    },
    "çº¢çƒ§é¸¡ç¿…": {
        "category": "ç‚’èœ",
        "time": "30åˆ†é’Ÿ",
        "img_url": "https://img1.doubanio.com/view/photo/l/public/s3435992077.jpg",
        "ingredients": [
            {"name": "é¸¡ç¿…ä¸­", "amount": "300å…‹"},
            {"name": "å†°ç³–", "amount": "15å…‹"},
            {"name": "ç”ŸæŠ½", "amount": "10æ¯«å‡"},
            {"name": "å…«è§’", "amount": "1ä¸ª"}
        ],
        "steps": "1. é¸¡ç¿…ç„¯æ°´ï¼ˆ5åˆ†é’Ÿï¼‰\n2. ç‚’ç³–è‰²ï¼ˆ2åˆ†é’Ÿï¼‰\n3. åŠ é¸¡ç¿…ç¿»ç‚’ä¸Šè‰²ï¼ˆ3åˆ†é’Ÿï¼‰\n4. åŠ å…«è§’+æ¸…æ°´ç„–15åˆ†é’Ÿ\n5. æ”¶æ±åŠ ç›è°ƒå‘³ï¼ˆ2åˆ†é’Ÿï¼‰",
        "alternatives": "é¸¡ç¿…ä¸­â†’é¸¡ç¿…æ ¹ï¼ˆ300å…‹ï¼‰",
        "nutrition": "çƒ­é‡380å¤§å¡ | å’¸ç”œå…¥å‘³",
        "tips": "ç‚’ç³–è‰²å°ç«ï¼Œé¿å…ç³Šé”…å‘è‹¦"
    },
    "æ¸…ç‚’ç§‹è‘µ": {
        "category": "ç‚’èœ",
        "time": "10åˆ†é’Ÿ",
        "img_url": "https://img2.doubanio.com/view/photo/l/public/s3435992078.jpg",
        "ingredients": [
            {"name": "ç§‹è‘µ", "amount": "250å…‹"},
            {"name": "è’œæœ«", "amount": "10å…‹"},
            {"name": "ç›", "amount": "3å…‹"},
            {"name": "ç”ŸæŠ½", "amount": "5æ¯«å‡"}
        ],
        "steps": "1. ç§‹è‘µç„¯æ°´åˆ‡æ®µï¼ˆ3åˆ†é’Ÿï¼‰\n2. çƒ­æ²¹çˆ†é¦™è’œæœ«ï¼ˆ1åˆ†é’Ÿï¼‰\n3. åŠ ç§‹è‘µç¿»ç‚’4åˆ†é’Ÿ\n4. åŠ ç”ŸæŠ½ç›è°ƒå‘³ï¼ˆ1åˆ†é’Ÿï¼‰",
        "alternatives": "ç§‹è‘µâ†’èŠ¦ç¬‹ï¼ˆ250å…‹ï¼‰",
        "nutrition": "çƒ­é‡70å¤§å¡ | å¯Œå«é»è›‹ç™½",
        "tips": "ç§‹è‘µç„¯æ°´å»æ¶©ï¼Œå£æ„Ÿæ›´å¥½"
    },
    "è¥¿èŠ¹ç‚’è…°æœ": {
        "category": "ç‚’èœ",
        "time": "12åˆ†é’Ÿ",
        "img_url": "https://img9.doubanio.com/view/photo/l/public/s3435992079.jpg",
        "ingredients": [
            {"name": "è¥¿èŠ¹", "amount": "200å…‹"},
            {"name": "è…°æœ", "amount": "50å…‹"},
            {"name": "ç›", "amount": "2å…‹"},
            {"name": "é¦™æ²¹", "amount": "3æ¯«å‡"}
        ],
        "steps": "1. è¥¿èŠ¹åˆ‡æ®µç„¯æ°´ï¼ˆ3åˆ†é’Ÿï¼‰\n2. è…°æœå°ç«ç‚’é¦™ï¼ˆ2åˆ†é’Ÿï¼‰\n3. åŠ è¥¿èŠ¹ç¿»ç‚’4åˆ†é’Ÿ\n4. åŠ ç›é¦™æ²¹è°ƒå‘³ï¼ˆ1åˆ†é’Ÿï¼‰",
        "alternatives": "è…°æœâ†’æä»ï¼ˆ50å…‹ï¼‰",
        "nutrition": "çƒ­é‡180å¤§å¡ | è„†å«©é¦™ç”œ",
        "tips": "è…°æœåˆ«ç‚’å¤ªä¹…ï¼Œé¿å…ç„¦ç³Š"
    },
    # ç”œç‚¹/æ³¥ç±»ï¼ˆæ–°å¢5é“é‡Œçš„å‰2é“ï¼‰
    "èŠ’æœè¥¿ç±³éœ²": {
        "category": "ç”œç‚¹",
        "time": "40åˆ†é’Ÿ",
        "img_url": "https://img2.doubanio.com/view/photo/l/public/s3435992080.jpg",
        "ingredients": [
            {"name": "è¥¿ç±³", "amount": "50å…‹"},
            {"name": "èŠ’æœ", "amount": "200å…‹"},
            {"name": "ç‰›å¥¶", "amount": "200æ¯«å‡"},
            {"name": "å†°ç³–", "amount": "20å…‹"}
        ],
        "steps": "1. è¥¿ç±³ç…®è‡³é€æ˜ï¼ˆ20åˆ†é’Ÿï¼‰\n2. èŠ’æœåˆ‡ä¸ï¼ˆ5åˆ†é’Ÿï¼‰\n3. ç‰›å¥¶+å†°ç³–ç…®5åˆ†é’Ÿ\n4. æ”¾å‡‰ååŠ è¥¿ç±³èŠ’æœï¼ˆ5åˆ†é’Ÿï¼‰",
        "alternatives": "èŠ’æœâ†’è‰è“ï¼ˆ200å…‹ï¼‰",
        "nutrition": "çƒ­é‡210å¤§å¡ | é¦™ç”œè§£æš‘",
        "tips": "è¥¿ç±³ç…®å¥½åè¿‡å‡‰æ°´ï¼Œæ›´Qå¼¹"
    },
    "æ¤°æ±èŠ‹åœ†": {
        "category": "ç”œç‚¹",
        "time": "60åˆ†é’Ÿ",
        "img_url": "https://img9.doubanio.com/view/photo/l/public/s3435992081.jpg",
        "ingredients": [
            {"name": "çº¢è–¯", "amount": "150å…‹"},
            {"name": "æœ¨è–¯ç²‰", "amount": "100å…‹"},
            {"name": "æ¤°æ±", "amount": "200æ¯«å‡"},
            {"name": "å†°ç³–", "amount": "15å…‹"}
        ],
        "steps": "1. çº¢è–¯è’¸ç†Ÿå‹æ³¥ï¼ˆ15åˆ†é’Ÿï¼‰\n2. åŠ æœ¨è–¯ç²‰æ‰æˆå›¢ï¼ˆ10åˆ†é’Ÿï¼‰\n3. æ“æˆèŠ‹åœ†ç…®è‡³æµ®èµ·ï¼ˆ5åˆ†é’Ÿï¼‰\n4. æ¤°æ±+å†°ç³–ç…®5åˆ†é’Ÿ\n5. æ··åˆèŠ‹åœ†æ”¾å‡‰ï¼ˆ5åˆ†é’Ÿï¼‰",
        "alternatives": "çº¢è–¯â†’ç´«è–¯ï¼ˆ150å…‹ï¼‰",
        "nutrition": "çƒ­é‡280å¤§å¡ | Qå¼¹é¦™ç”œ",
        "tips": "æœ¨è–¯ç²‰åˆ†æ¬¡åŠ ï¼Œé¿å…å¤ªå¹²"
    }
}

# ========== é£Ÿæè¯†åˆ«å‡½æ•° ==========
def recognize_ingredients(text):
    text_lower = text.strip().lower()
    ingredient_keywords = {
        "è¥¿å…°èŠ±": ["è¥¿å…°èŠ±"], "é¸¡ç¿…": ["é¸¡ç¿…"], "ç§‹è‘µ": ["ç§‹è‘µ"],
        "è¥¿èŠ¹": ["è¥¿èŠ¹"], "èŠ’æœ": ["èŠ’æœ"], "çº¢è–¯": ["çº¢è–¯"]
    }
    recognized = []
    for ing, keywords in ingredient_keywords.items():
        for kw in keywords:
            if kw in text_lower:
                recognized.append(ing)
                break
    return list(set(recognized))

# ========== é¡µé¢å¸ƒå±€ ==========
st.title("ğŸ³ å…¨èƒ½å¨ç¥åŠ©æ‰‹ï¼ˆç¬¬äºŒéƒ¨åˆ†ï¼š10é“èœï¼‰")
st.markdown("### åŒ…å«æ–°å¢å10é“ï¼šç‚’èœ+ç”œç‚¹")

with st.sidebar:
    st.header("ğŸ¥¦ é£Ÿæè¾“å…¥")
    user_input = st.text_input("è¾“å…¥é£Ÿæï¼ˆå¦‚ï¼šè¥¿å…°èŠ± é¸¡ç¿…ï¼‰", "è¥¿å…°èŠ±")
    st.header("ğŸ½ï¸ èœè°±ç±»å‹")
    categories = ["ç‚’èœ", "ç”œç‚¹", "å…¨éƒ¨"]
    selected_cats = st.multiselect("é€‰æ‹©ç±»å‹", categories, default=["å…¨éƒ¨"])
    st.header("â±ï¸ æ—¶é—´è¦æ±‚")
    max_time = st.slider("æœ€å¤§åˆ¶ä½œæ—¶é—´ï¼ˆåˆ†é’Ÿï¼‰", 8, 60, 30)
    search_btn = st.button("ğŸ” æœç´¢èœè°±", type="primary", use_container_width=True)

# ========== æœç´¢é€»è¾‘ ==========
if search_btn:
    recognized = recognize_ingredients(user_input)
    if recognized:
        st.success(f"âœ… è¯†åˆ«é£Ÿæï¼š{', '.join(recognized)}")
        filtered = []
        for name, rec in RECIPES.items():
            ing_list = [i['name'] for i in rec['ingredients']]
            if not any(ing in ing_list for ing in recognized):
                continue
            if "å…¨éƒ¨" not in selected_cats and rec['category'] not in selected_cats:
                continue
            if int(rec['time'].split("åˆ†é’Ÿ")[0]) > max_time:
                continue
            filtered.append((name, rec))
        if filtered:
            for name, rec in filtered:
                with st.expander(f"ğŸ² {name} | {rec['category']} | {rec['time']}", expanded=True):
                    col1, col2 = st.columns([1, 2])
                    with col1:
                        st.image(load_image_from_url(rec['img_url']), caption=name, use_column_width=True)
                    with col2:
                        st.markdown("**ğŸ¥— é£Ÿææ¸…å•**")
                        for ing in rec['ingredients']:
                            st.write(f"- {ing['name']}ï¼š{ing['amount']}")
                        st.markdown("**ğŸ‘¨â€ğŸ³ åˆ¶ä½œæ­¥éª¤**")
                        st.write(rec['steps'])
                        st.markdown(f"**ğŸ’¡ å°è´´å£«**ï¼š{rec['tips']}")
                        st.markdown(f"**ğŸ“Š è¥å…»å‚è€ƒ**ï¼š{rec['nutrition']}")
                        if rec.get('alternatives'):
                            st.markdown(f"**ğŸ”„ æ›¿ä»£æ–¹æ¡ˆ**ï¼š{rec['alternatives']}")
        else:
            st.warning("âš ï¸ æš‚æ— åŒ¹é…çš„èœè°±")
    else:
        st.error("âŒ æœªè¯†åˆ«åˆ°æœ‰æ•ˆé£Ÿæï¼Œè¯·é‡æ–°è¾“å…¥")
